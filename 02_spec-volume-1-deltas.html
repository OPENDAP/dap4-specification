<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.23">
<meta name="author" content="2024-10-23">
<title>DAP4: Specification Volume 1 Deltas</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.square{list-style-type:square}
ul.circle ul:not([class]),ul.disc ul:not([class]),ul.square ul:not([class]){list-style:inherit}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child{border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:first-child,.sidebarblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child,.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active,#footnotes .footnote a:first-of-type:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,td.hdlist1,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<style>
pre.rouge table td { padding: 5px; }
pre.rouge table pre { margin: 0; }
pre.rouge, pre.rouge .w {
  color: #24292f;
  background-color: #f6f8fa;
}
pre.rouge .k, pre.rouge .kd, pre.rouge .kn, pre.rouge .kp, pre.rouge .kr, pre.rouge .kt, pre.rouge .kv {
  color: #cf222e;
}
pre.rouge .gr {
  color: #f6f8fa;
}
pre.rouge .gd {
  color: #82071e;
  background-color: #ffebe9;
}
pre.rouge .nb {
  color: #953800;
}
pre.rouge .nc {
  color: #953800;
}
pre.rouge .no {
  color: #953800;
}
pre.rouge .nn {
  color: #953800;
}
pre.rouge .sr {
  color: #116329;
}
pre.rouge .na {
  color: #116329;
}
pre.rouge .nt {
  color: #116329;
}
pre.rouge .gi {
  color: #116329;
  background-color: #dafbe1;
}
pre.rouge .kc {
  color: #0550ae;
}
pre.rouge .l, pre.rouge .ld, pre.rouge .m, pre.rouge .mb, pre.rouge .mf, pre.rouge .mh, pre.rouge .mi, pre.rouge .il, pre.rouge .mo, pre.rouge .mx {
  color: #0550ae;
}
pre.rouge .sb {
  color: #0550ae;
}
pre.rouge .bp {
  color: #0550ae;
}
pre.rouge .ne {
  color: #0550ae;
}
pre.rouge .nl {
  color: #0550ae;
}
pre.rouge .py {
  color: #0550ae;
}
pre.rouge .nv, pre.rouge .vc, pre.rouge .vg, pre.rouge .vi, pre.rouge .vm {
  color: #0550ae;
}
pre.rouge .o, pre.rouge .ow {
  color: #0550ae;
}
pre.rouge .gh {
  color: #0550ae;
  font-weight: bold;
}
pre.rouge .gu {
  color: #0550ae;
  font-weight: bold;
}
pre.rouge .s, pre.rouge .sa, pre.rouge .sc, pre.rouge .dl, pre.rouge .sd, pre.rouge .s2, pre.rouge .se, pre.rouge .sh, pre.rouge .sx, pre.rouge .s1, pre.rouge .ss {
  color: #0a3069;
}
pre.rouge .nd {
  color: #8250df;
}
pre.rouge .nf, pre.rouge .fm {
  color: #8250df;
}
pre.rouge .err {
  color: #f6f8fa;
  background-color: #82071e;
}
pre.rouge .c, pre.rouge .ch, pre.rouge .cd, pre.rouge .cm, pre.rouge .cp, pre.rouge .cpf, pre.rouge .c1, pre.rouge .cs {
  color: #6e7781;
}
pre.rouge .gl {
  color: #6e7781;
}
pre.rouge .gt {
  color: #6e7781;
}
pre.rouge .ni {
  color: #24292f;
}
pre.rouge .si {
  color: #24292f;
}
pre.rouge .ge {
  color: #24292f;
  font-style: italic;
}
pre.rouge .gs {
  color: #24292f;
  font-weight: bold;
}
</style>
</head>
<body class="article">
<div id="header">
<h1>DAP4: Specification Volume 1 Deltas</h1>
<div class="details">
<span id="author" class="author">2024-10-23</span><br>
<span id="revdate">Collection of emails going back to July 2013 regarding DAP4 and it’s implementation.</span>
</div>
<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_constraints_subsetting_unified_syntax">1. Constraints, subsetting: unified syntax</a></li>
<li><a href="#_constraints_subsetting_and_maps">2. constraints, subsetting and maps</a></li>
<li><a href="#_response_information">3. response information</a></li>
<li><a href="#_using_the_url_query_string_keyvalue_notation">4. using the url query string key=value notation</a></li>
<li><a href="#_sequences_with_structures_and_the_resulting_ces">5. sequences with structures and the resulting CEs</a></li>
<li><a href="#_basic_testing_support">6. basic testing support</a></li>
<li><a href="#_fqns_in_a_dmrdata_response">7. FQNs in a DMR/Data response</a></li>
<li><a href="#_augment_the_vol1_spec_with_details_about_ce_effects_on_a_dmr">8. augment the vol1 spec with details about CE effects on a DMR</a></li>
<li><a href="#_sequence_serialization_how_to_serialize_a_zero_length_sequence">9. sequence serialization: how to serialize a zero-length sequence</a></li>
<li><a href="#_ieee_754_for_real_numbers">10. IEEE 754 for real numbers</a></li>
<li><a href="#_how_big_are_arrays_64_bits_63_bits_61_bits_signed_unsigned">11. how big are arrays? 64 bits? 63 bits? 61 bits? signed? unsigned?</a></li>
<li><a href="#_about_the_end_chunk_in_a_chunked_response">12. About the end chunk in a chunked response</a></li>
<li><a href="#_where_we_encode_the_byte_order_for_a_dap4_data_response">13. where we encode the byte order for a DAP4 Data response</a></li>
<li><a href="#_order_of_stuff_in_the_dmr">14. Order of stuff in the DMR</a></li>
<li><a href="#_limitations_on_the_dmr_dim_element">15. limitations on the DMR Dim element</a></li>
<li><a href="#_names">16. names</a></li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_constraints_subsetting_unified_syntax">1. Constraints, subsetting: unified syntax</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Dennis and I decided on this syntax for CEs that encompasses simple
projections and array slicing, including when the arrays use shared
dims. No grammar, just examples of what’s allowed and explanations of
what the examples mean.</p>
</div>
<div class="paragraph">
<p>CEs for DAP4</p>
</div>
<div class="paragraph">
<p>CE Syntax</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="xml"><span class="nt">&lt;dataset</span> <span class="na">name=</span><span class="s">t1</span><span class="nt">&gt;</span>
     <span class="nt">&lt;dimension</span> <span class="na">name=</span><span class="s">d</span> <span class="na">size=</span><span class="s">20/</span><span class="nt">&gt;</span>
     <span class="nt">&lt;byte</span> <span class="na">name=</span><span class="s">b</span><span class="nt">&gt;</span>
         <span class="nt">&lt;dim</span> <span class="na">size=</span><span class="s">10/</span><span class="nt">&gt;</span>
     <span class="nt">&lt;/byte&gt;</span>
     <span class="nt">&lt;byte</span> <span class="na">name=</span><span class="s">c</span><span class="nt">&gt;</span>
          <span class="nt">&lt;dim</span> <span class="na">name=</span><span class="s">d/</span><span class="nt">&gt;</span>
    <span class="nt">&lt;/byte&gt;</span>
    <span class="nt">&lt;structure</span> <span class="na">name=</span><span class="s">s</span><span class="nt">&gt;</span>
         <span class="nt">&lt;byte</span> <span class="na">name=</span><span class="s">d</span><span class="nt">&gt;</span>
             <span class="nt">&lt;dim</span> <span class="na">name=</span><span class="s">d/</span><span class="nt">&gt;</span>
         <span class="nt">&lt;/byte&gt;</span>
         <span class="nt">&lt;byte</span> <span class="na">name=</span><span class="s">e</span><span class="nt">&gt;</span>
              <span class="nt">&lt;dim</span> <span class="na">name=</span><span class="s">d/</span><span class="nt">&gt;</span>
              <span class="nt">&lt;dim</span> <span class="na">size=</span><span class="s">5/</span><span class="nt">&gt;</span>
        <span class="nt">&lt;/byte&gt;</span>
         <span class="nt">&lt;byte</span> <span class="na">name=</span><span class="s">f</span><span class="nt">&gt;</span>
             <span class="nt">&lt;dim</span> <span class="na">name=</span><span class="s">d/</span><span class="nt">&gt;</span>
         <span class="nt">&lt;/byte&gt;</span>
    <span class="nt">&lt;/structure&gt;</span>
<span class="nt">&lt;/dataset&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Some CEs:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>b</code><br>
Return just b</p>
</li>
<li>
<p><code>b;c</code><br>
Return both b and c</p>
</li>
<li>
<p><code>b[1:4]</code><br>
Slice <code>b</code> so that only elements 1 through 4 are returned. Since <code>b</code> does not
use a shared dim the special properties of shared dims (sdims) don’t
matter. Although in this case it doesn’t matter</p>
</li>
<li>
<p><code>c[]</code><br>
Return all of <code>c</code> but because a local slicing operation was performed, <code>c</code>
is returned with dim 1 as an anonymous dim, not the sdim &#8216;d&#8217;</p>
</li>
<li>
<p><code>/d=[2:5];c[]</code><br>
Slice the sdim &#8216;d&#8217; using <code>[2:5]</code>. For the variable <code>c</code>, apply that slice
and return the result. In this case <code>c</code> will be shown with the <code>sdmi</code> &#8216;d&#8217;
but that <code>sdim</code> will be of size <code>4</code>. Thus the <em>[]</em> means two different
things for an array with shared dims. Either return the whole dim as if
a local slice was made or since that sdim was sliced (previously in the
CE), use that slice. We use an explicit thing to cover the case where an
array has both sdims and anonymous dims.</p>
</li>
<li>
<p><code>/d=[2:5];/s.d[]</code><br>
Apply the sdim slice to the array &#8216;d&#8217;. Since arrays and dims can have
the same name, we use an <em>=</em> to mean <em>this is a sdim and I’m slicing it</em>
in the CE. This is not a great example of that since the var and sdim
have different FQNs, but it’s possible for them to have the same FQN,
hence the <em>=</em></p>
</li>
<li>
<p><code>/d=[2:5];s.e[][]</code><br>
Similarly, apply the slice to the first dim (using the sdim slice) and
get all of the second dime</p>
</li>
<li>
<p><code>/d=[2:5];s.e[][1:3]</code><br>
Use the sdim slice and apply a slice to the second (anonymous) dim.
really this is the same case as above, but with different values for the
second dim’s slice operator</p>
</li>
<li>
<p><code>/d=[2:5];s.e[1:4][1:3]</code><br>
Return e with two anonymous dims; based on the original sizes. That is,
even though the first dim in the DMR uses the sdim &#8216;d&#8217;, since we’re
using the local slicing operator, we take the 1:4 slice from the
20-element dimension. The only time a sdim slice applies is when an
array is declared as using it in the DMR and <em>[]</em> appears for that dim
in the CE.</p>
</li>
<li>
<p><code>/d=[2:5];s\{d[],f[]}</code><br>
Slicing apples recursively</p>
</li>
<li>
<p><code>/d=[2:5];s.d[];s.f[]</code><br>
Same result as the previous CE</p>
</li>
<li>
<p><code>/d=[2:5];s\{d[],e[][1]}</code><br></p>
</li>
<li>
<p><code>/d=[2:5];s[1:3]\{d,f}</code><br>
This slicing op applies to &#8216;s&#8217; (which makes no sense with the example
dataset; image it does make sense ;-)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>CDMR: Will be a subset of the DMR. It may reference shared dims but will
not create any dims</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>seq\{i,j,k} | j &lt; 10</code><br>
This filter, shown with a Sequence <em>seq</em> (not int he example DMR) is
applied to everything in the clause. CEs are made up of clauses
separated by <em>;</em> marks.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_constraints_subsetting_and_maps">2. constraints, subsetting and maps</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Bob Simons sent this:<br>
I liked your talk about OPeNDAP yesterday at ESIP. I especially liked
your phrases &#8220;select by index&#8221;, &#8220;select by coordinate&#8221;, &#8220;select by
value&#8221;. They are useful phrases.</p>
</div>
<div class="paragraph">
<p>I understand and like &#8220;select by index&#8221;. But since it is also useful
to select by coordinate value, it would be great if OPeNDAP 4 would
support the optional syntax &#8220;(value)&#8221; in projection constraints, where
the value is converted to the nearest index. For example,
variable[(startValue):stride:(stopValue)] would be converted by the
server to variable[startIndex:stride:stopIndex] This would allow users
to specify requests</p>
</div>
<div class="paragraph">
<p>For time variables (with units of &#8220;someTimeUnit since someTime&#8221;), it
would be great if the startValue or stopValue could be expressed in
whatever the dimensions units are (e.g., in &#8220;minutes since
1980-01-01&#8221;) <strong>or</strong> as an ISO 8601:2004 &#8220;extended&#8221;) time (e.g.,
1985-12-31T23:59:59Z).</p>
</div>
<div class="paragraph">
<p>This also solves problems with datasets that just offer the latest e.g.,
30 days of data. Currently, if a user requests the time values, finds
the index for a current date, and requests the data with that time
index, the dataset may have changed so that the requested index no
longer has the value the user expects.</p>
</div>
<div class="paragraph">
<p>Is there any chance that the OPeNDAP 4 specification could include the
() notation in projection constraints?</p>
</div>
<div class="paragraph">
<p>Thanks for considering this.</p>
</div>
<div class="paragraph">
<p>And we had a long thread about it:<br>
Dan- I think what might work is the use of functions inside of
projections. e.g. velocity[f(start):stride:f(end)] where f converts
something in say, time or lat or lon to an index. - Dennis</p>
</div>
<div class="paragraph">
<p>Daniel Holloway wrote: Dennis, James, There are several proposals within
the wiki that seem applicable to this problem, what about is it about
this particular problem/solution that breaks the ideas put forth in the
&#8216;filter constraints&#8217; proposal that could not be addressed
(potentially) by extending that idea somewhat? Similarly in the
&#8216;constraint expressions&#8217; proposal, and somewhat less though related in
the &#8216;subset arrays and grids by value&#8217;, granted the problem as stated
is more grid projection using selection by value on the map vectors. Dan
On Jul 16, 2013, at 9:47 PM, Dennis Heimbigner wrote: I must confess to
be intrigued/baffled at Bob’s mixing of time endpoints and index
strides. As for using &#8220;nearest&#8221; even that requires a specification of
rounding.</p>
</div>
<div class="paragraph">
<p>In any case, and to be somewhat cliched, this seems like a job for a
server side function.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Dennis.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>p.s. coordinate variables are associated with other variables using the
&lt;Map&gt;…&lt;/Map&gt; construct.</p>
</div>
<div class="paragraph">
<p>Dave Fulker wrote: On Tue, Jul 16, 2013 at 9:44 AM, John Caron
&lt;<a href="mailto:caron@unidata.ucar.edu">caron@unidata.ucar.edu</a>&gt; wrote: ok, i understand your concern a bit
better. you are considering the general case where coordinate values are
all over the place. but if they are monotonic, then the user makes a
range request in coordinate space and the server translates this quite
easily into a range request in index space.</p>
</div>
<div class="paragraph">
<p>im pretty sure this is what bob is proposing. By my reading, Bob’s
request does <strong>not</strong> include coordinate values in the stride; he asks for
coordinate-to-index translation only at the interval endpoints and
expects only the <strong>nearest</strong> values there, so interpolation is never
required. If we want to support coordinate values in the stride
argument, some notion of &#8220;nearest&#8221; might be plausible (as Dennis
hints), but I suspect Bob omitted this deliberately. It’s not even clear
to me that monotonicity is a requirement; without it, users could
separate apples from oranges without knowing their indices.  ;-) I
personally think Bob’s notation could be accommodated directly in DAP4
without violating our KISS commitment <strong>if we restrict it to 1-D maps</strong>.
Use with N-D maps strikes me as complicated, and I think it leads to
questions of the sort Nathan raises, so I would not try to bite off that
one (within DAP4). Also, I’m less inclined toward including Bob’s
time-translation request because it involves interpreting the &#8220;units&#8221;
attribute. For me that smacks of extension along the lines Ethan
suggests. Stated another way, I can see the ( ) to [ ] translation as
truly domain independent, but notions of time seem less so. Finally,
could someone remind me: are coordinate maps a formal data type in DAP4,
or are they established via naming conventions? Thanks, Dave On
7/16/2013 9:31 AM, Dennis Heimbigner wrote:</p>
</div>
<div class="paragraph">
<p>Thinking about Nathan’s last comment leads me to dissect this issue a
bit more.</p>
</div>
<div class="paragraph">
<p>Suppose we have the following schema using time as in Bob’s original
request. The lat/lon issue is similar except in 2 dimensions.</p>
</div>
<div class="paragraph">
<p>dimensions: time=… variables:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>float velocity(time);
float time(time);</pre>
</div>
</div>
<div class="paragraph">
<p>If we want to get the time of velocity(i), then we can compute time(i).</p>
</div>
<div class="paragraph">
<p>The inverse of this is to ask for the velocity at time 1/1/13, for
example.</p>
</div>
<div class="paragraph">
<p>If I understand Bob’s suggestion, he is saying one should be able to ask
for velocity(1/1/13) and get the velocity at that time. Or similarly,
ask for the range of velocities(1/1/13:1hr:1/2/13).</p>
</div>
<div class="paragraph">
<p>The problem comes in figuring out to choose which integer indices of the
time dimension are be included in the set given that it may be the case
that none of the values 1/1/13,1/1/13+2hr,…1/2/13 are actually in the
time(time) variable. This means we need to define an algorithm to decide
which indices are in the set and which are out. Finding the initial
starting index requires searching time(time) to find, say, the first i
such that time(i) &gt;= 1/1/13. For each additional point, we need to
either search for another &#8220;closest&#8221; point or interpolate between two
adjacent velocity values based on some pair of covering points in the
time(time) variable.</p>
</div>
<div class="paragraph">
<p>As Nathan points out, we can approximate the above by allowing domain
based query. So we might say \{velocity(x,y)|time(x) &gt;= 1/1/13 &amp;&amp;
time(x) &#8656; 1/2/13} This has at least the advantage of being well defined
and domain independent (more or less). When we met in Boulder, some of
our discussions addressed this kind of query, but no resolution. It is
fair to say, however, that it is still on our agenda.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Dennis</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Daniel Holloway wrote:</p>
</div>
<div class="paragraph">
<p>On Jul 16, 2013, at 12:42 AM, Nathan Potter wrote:</p>
</div>
<div class="paragraph">
<p>Isn’t it reasonable to factor out the lat/long coordinate issue? Can we
not consider the two cases: a) Subsetting range values of array or Grid
by value - if a particular value that exists in the Array/Grid fulfills
the selection constraint then it is included in the response.</p>
</div>
<div class="paragraph">
<p>b) Subsetting by Domain value - this I think is what Dennis is
referring to - where the constrained specifies which values in the
domain are acceptable. For the map upon which the constraint is applied
has a value at a particular index i, then all of the requested variables
that utilize that map should have their i’th value included in the
result.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>While I can see how 'b' might be viewed as a special constraint case</pre>
</div>
</div>
<div class="paragraph">
<p>for &#8216;grids&#8217; at some point it becomes a similar problem to constraining
any array by value, that is what are the potential changes to the
response type, if any, (.e.g., sparse array, mask, …).</p>
</div>
<div class="paragraph">
<p>What is actually returned in both cases is the thing I think we would
have to work out (a sparse array? a mask?)</p>
</div>
<div class="paragraph">
<p>I don’t see how interpolation/search comes into it. So maybe Dennis you
could elaborate on your concerns - I’m not following you.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>First, assuming his intent is simply to select array indices of</pre>
</div>
</div>
<div class="paragraph">
<p>the dependent variable based on &#8216;selection by value&#8217; on the
independent, or coordinate, variables using only the values in the
coordinate variables themselves, that is, (.e.g., not supporting iso8601
time-values in the constraints and expecting conversion to
seconds-since-1970). Then minimally there’s the issue at the boundaries
for any particular extent, or when discrete values are requested when
the domain variable (in OGC parlance) is a coverage and not a point. So,
regardless of geo or any specific domain there will be some extent of
interpolation and/or search, and how that is communicated in the
response. Also, in DAP-4 we’re extending grid map-vectors to be
n-dimensional, though typically size 1 or 2 is my guess, so the
resulting shape for constrained variables will become quite important to
the end-user client.
- Dan</p>
</div>
<div class="paragraph">
<p>Thanks, Nathan</p>
</div>
<div class="paragraph">
<p>On Jul 15, 2013, at 6:27 PM, Dennis Heimbigner wrote:</p>
</div>
<div class="paragraph">
<p>Remember that what was being proposed is to map from the specification
of a geo lat/long range to a set of integer indices. The inverse is not
a problem (IMO). Going from lat/long to indices requires, I think,
algorithms to deal with interpolation and search. I do not think,
personally, that there is likely to be any agreement about which
algorithms to use.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Dennis</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Nathan Potter wrote:</p>
</div>
<div class="paragraph">
<p>I think it’s not a coordinates question but a select/subset by value
question. If we limit our view of the problem to just subsetting arrays,
Grids, and Sequences then I think if we solve the resulting data model
issues (sparse arrays? masks? etc.) then we might have something really
useful. And I don’t think it adds a huge burden of thought or work.
Unless of course I am mistaken and the possible result space turns out
to be awful to represent. Nathan On Jul 15, 2013, at 4:38 PM, John Caron
wrote:</p>
</div>
<div class="paragraph">
<p>Im not so sure, it might be very low hanging fruit. Note that it doesnt
require georeferencing or feature types, just coordinates (maps). On the
grid data type, i think all the semantics are already there. OTOH, it
would require some clarifications.</p>
</div>
<div class="paragraph">
<p>On 7/15/2013 4:00 PM, Ethan Davis wrote:</p>
</div>
<div class="paragraph">
<p>I agree with Dennis on this one.</p>
</div>
<div class="paragraph">
<p>While Bob’s proposal is very simple and elegant in its request encoding,
it assumes things outside of the core DAP4 data model. So, to my mind it
doesn’t belong in the core specification.</p>
</div>
<div class="paragraph">
<p>It might make a good extension. But it would need to be fleshed out. It
would need a few extensions to the DMR. For example, a way to indicate
when it can be used (which datasets, which arrays, which dimensions).
And, as Dennis mentions, the same for the interpolation algorithm.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Ethan</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>On 7/15/2013 1:12 PM, Dennis Heimbigner wrote:</p>
</div>
<div class="paragraph">
<p>For what its worth, my philosphy here is that DAP4 is intended to be the
lowest level representation for data. Any additional semantics such as
geographical coordinates and more generally feature types should be
implemented on top of DAP4. The relatively simple semantics of DAP4
should not be made more complicated by embedding feature types. For
example, embedding geographical coordinates requires defining the
interpolation algorithm as part of the standard. If some other algorithm
is desired, then how is that to be supported?</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Dennis</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Dave Fulker wrote:</p>
</div>
<div class="paragraph">
<p>Here’s Bob Simons’ reply to my request for his ESIP slides. I think that
the perspective he presents (note, e.g., the slide that he titled
&#8220;Don’t Treat In-Situ/Tabular Data Like Gridded Data&#8221;) should inform
our thinking as we finalize DAP4. – Dave</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_response_information">3. response information</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We started down this path, then left it hanging, I think:
<a href="http://docs.opendap.org/index.php/DAP4:_Inclusion_of_response_metadata_in_the_DMR" class="bare">http://docs.opendap.org/index.php/DAP4:_Inclusion_of_response_metadata_in_the_DMR</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_using_the_url_query_string_keyvalue_notation">4. using the url query string key=value notation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Gallagher James wrote: Dennis, I’m thinking about, but have not really
worked thorough, the idea that DAP4 will separate server functions from
the Constraint Expression by passing those two things into the servers
using different key names in the query string. Something like &#8216;URL ?
eval = &lt;functions&gt; &amp; ce = &lt;constraint expr&gt;&#8217;. The semantics of this
would be that the &lt;functions&gt; (whatever that turns out to be) are
evaluated first and then the &lt;constraint expr&gt; is applied to the result.
If the &#8216;eval=&lt;functions&gt;&#8217; part of the query string is not given then
the constraint is applied to the dataset (and if the constraint is not
given the dataset is just returned in toto). Does this seem reasonable
to you?<br>
I am not sure. My immediate reaction is to ask how the client will know
what kind of constraint to write in the presence of an &#8216;eval=&#8217;; that
is, what is the DMR against which the constraint is written? - Dennis</p>
</div>
<div class="listingblock">
<div class="content">
<pre>We should elaborate on what the different keys might mean. _eval_ would
run a function(s) and produce a virtual dataset. The server would return
the DMR, etc., for that</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_sequences_with_structures_and_the_resulting_ces">5. sequences with structures and the resulting CEs</h2>
<div class="sectionbody">
<div class="paragraph">
<p>James Gallagher wrote: On Aug 2, 2013, at 7:04 PM, Dennis Heimbigner
wrote: Yes I did intend to allow nesting of Sequences and Structures. I
suspect that in the implementation I will come to regret it, but until
then…. My guess is that’s not so bad, but, I think we should our filters
to &#8216;id op constant&#8217; (and the positional variants) and not support &#8216;id
op id&#8217;. Or limit the latter case based on the scope of the ids (but I’d
rather not support it at all). James<br>
That sounds right to me; we can always extend it later if there is
sufficient reason Dennis</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_basic_testing_support">6. basic testing support</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We might make a collection of DMR files available for debugging/testing</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_fqns_in_a_dmrdata_response">7. FQNs in a DMR/Data response</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Gallagher James wrote: Are the Dim, Map and Enum elements’ name
attributes always FQNs? So &lt;Dim name=&#8220;x&#8221;/&gt; is never valid and should
always be a FQN like: &lt;Dim name=&#8220;/x&#8221;/&gt; ?<br>
Dennis: That is what I put in the spec. The argument is that it is
easier for machines while still making it reasonably readable by a
person.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_augment_the_vol1_spec_with_details_about_ce_effects_on_a_dmr">8. augment the vol1 spec with details about CE effects on a DMR</h2>
<div class="sectionbody">
<div class="paragraph">
<p>It occurs to me that we need to augment our proposed constraint
expression grammars with a description of what kinds of DMRs will result
from our proposed constraints.</p>
</div>
<div class="paragraph">
<p>That is, given a constraint and a DMR for the unconstrained dataset,
describe the DMR that corresponds to the result of applying the
constraint.</p>
</div>
<div class="paragraph">
<p>To that end, I have put up a new proposal based on describing rules for
constructing the DMR that results from a constraint.
<a href="http://docs.opendap.org/index.php/DAP4:_Alternate_Proposal_for_a_Constraint_Expression_Syntax" class="bare">http://docs.opendap.org/index.php/DAP4:_Alternate_Proposal_for_a_Constraint_Expression_Syntax</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_sequence_serialization_how_to_serialize_a_zero_length_sequence">9. sequence serialization: how to serialize a zero-length sequence</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Gallagher James wrote: Dennis, Looking at Sequence and thinking about CE
evaluation: When there’s a nested Sequence like this:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>Seq {
 Int32 i;
 Int32 j;
 Seq {
    Int32 k;
    Int32 l;
 } inner;
} outer;</pre>
</div>
</div>
<div class="paragraph">
<p>And a CE requests all of outer (which means inner too) such that k &gt; 10,
what should be sent when k is not &gt; 10? Should i and j still be sent and
an empty inner (so the count would be 0)? This would be my preference
since the alternative is very tricky to code. Is that your
understanding?<br>
Dennis: Yes, a count of zero should be allowed.<br>
also: My recollection is that we decided to only allow filtering based
on the outermost variables (i and j in this case) and filtering based on
k would be illegal. Maybe we should revisit this decision. the best
alternative I can think of in this case is that all records in outer are
kept and all records in inner are filtered (for each record in outer).</p>
</div>
<div class="paragraph">
<p><strong>nb</strong>: This is a big deal for nested sequences because it you were to
require that zero-length child sequences suppress the serialization of
their parent sequence (as was the case with DAP2) the code to handle the
sequence serialization becomes very complex. We made the correct
decision here to allow child sequences to be zero length</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ieee_754_for_real_numbers">10. IEEE 754 for real numbers</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Gallagher James wrote: Dennis, When we adopted &#8216;reader make right&#8217; we
mostly talked about byte order; do you handle the case where one of the
two hosts does not use IEEE754 for either 32 or 64 bit reals?<br>
Reader makes it right was intended to apply only to byte order. We
should indeed enforce use of 754 as the only acceptable format. -Dennis</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_big_are_arrays_64_bits_63_bits_61_bits_signed_unsigned">11. how big are arrays? 64 bits? 63 bits? 61 bits? signed? unsigned?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Gallagher James wrote: I’m wondering what type should be used to hold
the number of elements in an array. I can’t find where in the spec it
says how big an array can be - is it an unsigned 64bit number of
elements? Or unsigned 32 bits?<br>
Dennis: it is a signed 64 bit integer.<br>
Yes signed. The argument is that interpretive languages (Java, python…)
are not good at handling unsigned 64 bit numbers, so I chose to stick to
signed 64 bit integer, which is effectively a 63 bit int We need to fix
the text. Here’s what the dc says: … The total number of elements in an
Array MUST NOT exceed \$2^(64)-1\$.</p>
</div>
<div class="paragraph">
<p>In the telecon we decided that the make number of elements was \$2^(61)-1\$.
We decided that the number of bytes for an array should never be more
than \$2^(64)-1\$ bytes (because the size needs to be signed because Java and
Python don’t grok unsigned ints) and because C code will need to malloc
these and malloc won’t take more than a 64-bit int.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_about_the_end_chunk_in_a_chunked_response">12. About the end chunk in a chunked response</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Dennis, I’m tweaking my code to process the chunked responses and
thinking about what the end chunk means. Does the end chunk mean that
once any data it contains has be consumed EOF has been reached? Or is it
possible to have more data chunks (or an error chunk) after an end
chunk? James<br>
I believe the rule is that any sequence of chunks must stop at the first
end chunk or error chunk. The end chunk may or may not contain data. - Dennis</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_where_we_encode_the_byte_order_for_a_dap4_data_response">13. where we encode the byte order for a DAP4 Data response</h2>
<div class="sectionbody">
<div class="paragraph">
<p>On Sep 10, 2013, at 10:06 AM, Dennis Heimbigner &lt;<a href="mailto:dmh@unidata.ucar.edu">dmh@unidata.ucar.edu</a>&gt;
wrote: I think we agreed to put the serialization byte order in the http
headers. Do you want to revisit that decision? =Dennis<br>
Yes. There’s another part of the spec that says the response
document/body is all you need to read (of course, you need the spec too)
the document. The HTTP headers are generally lost by the time a client
gets the response body, so I think the byte order should go in the
response body somewhere. James<br>
ok with me. One possibility is a new flag in the chunk headers. -Dennis</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_order_of_stuff_in_the_dmr">14. Order of stuff in the DMR</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Gallagher James wrote: On Sep 5, 2013, at 9:30 AM, Dennis Heimbigner
wrote: I recall that we placed limits on which dimensions and maps and
enums could be referenced to be something in the same group or an
enclosing group. Given that, we could do this order: dimensions, enums,
variables, groups because the above rule would guarantee no forward
reference.<br>
OK, lets adopt this and change the grammar to reflect it. I’ll change
the rng file and check it in. As for group attributes, currently, I
print them at the very end of the group, but this is easily changed. I
would suggest however, that they be either at the very beginning or the
very end of the group. My vote is to put them at the end. =Dennis<br>
More info - we have adopted this as the correct order, although it
should be said that any order so long as everything is &#8216;defined before
use&#8217; is acceptable:<br>
For Atomic Variables I propose:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>dimension references</p>
</li>
<li>
<p>Attributes</p>
</li>
<li>
<p>maps</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For Seq/Struct I propose:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>fields</p>
</li>
<li>
<p>dim references</p>
</li>
<li>
<p>Attributes</p>
</li>
<li>
<p>maps</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>DMR Order of stuff… Personally, I think the best order is</p>
</div>
<div class="ulist">
<ul>
<li>
<p>dimdefs</p>
</li>
<li>
<p>enumdefs</p>
</li>
<li>
<p>variables</p>
</li>
<li>
<p>attributes</p>
</li>
<li>
<p>groups</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This keeps all of the per-group stuff (enum,dim,var,attr) together and
then the subgroups after that.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_limitations_on_the_dmr_dim_element">15. limitations on the DMR Dim element</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Gallagher James wrote: Dennis, In an array in DAP4, Can a Dim element
have both a name and a size? Is the name limited to only names of shared
Dimension elements (previously defined)? James<br>
Limited to previously defined dimensions. You can only specify a size
within an array. - Dennis</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_names">16. names</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Gallagher James wrote: Dennis, You might have guessed that my previous
question relates to looking up things (groups, variables, dimensions)
based on their FQN. Are we allowing a Group and a variable, for example,
to have the same name at the same lexical level (I hope not)? James<br>
I have assumed that yes, two decls of different kinds can have the same
name. This is obviously true for dimensions and variables, so I assumed
it held generally. Why is this causing a problem? - Dennis</p>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2024-10-23 14:10:21 -0700
</div>
</div>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  messageStyle: "none",
  tex2jax: {
    inlineMath: [["\\(", "\\)"]],
    displayMath: [["\\[", "\\]"]],
    ignoreClass: "nostem|nolatexmath"
  },
  asciimath2jax: {
    delimiters: [["\\$", "\\$"]],
    ignoreClass: "nostem|noasciimath"
  },
  TeX: { equationNumbers: { autoNumber: "none" } }
})
MathJax.Hub.Register.StartupHook("AsciiMath Jax Ready", function () {
  MathJax.InputJax.AsciiMath.postfilterHooks.Add(function (data, node) {
    if ((node = data.script.parentNode) && (node = node.parentNode) && node.classList.contains("stemblock")) {
      data.math.root.display = "block"
    }
    return data
  })
})
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-MML-AM_HTMLorMML"></script>
</body>
</html>